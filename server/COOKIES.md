# üç™ Using Cookies to Avoid YouTube Bot Detection

When YouTube blocks downloads with "Sign in to confirm you're not a bot" errors, using cookies from your browser can solve this issue.

## üéØ Quick Start

### Option 1: Automatic Cookie Export (Recommended)

1. **Visit YouTube in your browser** (within the last 30 minutes)
2. **Run the cookie export script:**
   ```bash
   node export-cookies.js
   ```
3. **Start your server** - it will automatically use the cookies.txt file

### Option 2: Different Browser
If Firefox doesn't work, try Chrome or Edge:
```bash
node export-cookies.js chrome
node export-cookies.js edge
```

## üìã How It Works

The system tries multiple strategies in this order:

1. **cookies.txt file** (if present) - Highest priority
2. **Firefox cookies** (automatic extraction)
3. **Chrome cookies** (automatic extraction)  
4. **Edge cookies** (automatic extraction)
5. **Minimal quality** (fallback)
6. **Lowest quality** (last resort)

## üîß Manual Cookie Export

### Method 1: Browser Extension
1. Install **"Get cookies.txt LOCALLY"** for Chrome or **"cookies.txt"** for Firefox
2. Visit YouTube and export cookies
3. Save as `cookies.txt` in the server directory

### Method 2: yt-dlp Command
```bash
yt-dlp --cookies-from-browser firefox --cookies cookies.txt "https://youtube.com/watch?v=dQw4w9WgXcQ" --skip-download
```

## üìÅ File Format

The cookies.txt file must be in **Mozilla/Netscape format**:
```
# Netscape HTTP Cookie File
# Generated by yt-dlp

.youtube.com	TRUE	/	FALSE	1234567890	cookie_name	cookie_value
```

## ‚ö†Ô∏è Important Notes

### Freshness Matters
- Cookies expire quickly (usually 30 minutes)
- Visit YouTube in your browser before exporting
- Re-export cookies if downloads start failing again

### Privacy & Security
- cookies.txt contains authentication data for ALL websites
- Keep this file secure and don't share it
- Delete old cookie files regularly

### Browser Requirements
- **Firefox**: Works best (recommended in yt-dlp FAQ)
- **Chrome**: Good fallback option
- **Edge**: Alternative if others fail
- **Safari**: Limited support

## üõ†Ô∏è Troubleshooting

### "Cookie file not found"
```bash
# Check if file exists
ls -la cookies.txt

# Re-export cookies
node export-cookies.js
```

### "Still getting bot detection"
1. **Fresh cookies**: Visit YouTube again and re-export
2. **Different browser**: Try `node export-cookies.js chrome`
3. **Wait**: Take a break for 30+ minutes
4. **Different IP**: Use VPN if available

### "Cookie export failed"
- Make sure you visited YouTube recently
- Try different browser: `node export-cookies.js chrome`
- Check browser permissions for cookie access

## üîÑ Automatic Strategy

The YouTube service automatically:

1. **Detects** if cookies.txt exists
2. **Prioritizes** manual cookies over auto-extraction
3. **Falls back** to browser cookie extraction if file method fails
4. **Retries** with different browsers if one fails
5. **Degrades** quality if all cookie methods fail

## üìù Example Workflow

```bash
# 1. Visit YouTube in Firefox
# (Browse a few videos)

# 2. Export cookies
node export-cookies.js

# 3. Verify file was created
ls -la cookies.txt

# 4. Start server (will auto-use cookies)
npm run dev

# 5. Downloads will now use your cookies automatically!
```

## üéØ Success Indicators

You'll see these messages when cookies are working:
```
[DOWNLOAD] Found cookies.txt file, prioritizing manual cookies
[DOWNLOAD] Trying strategy: cookieFile
[DOWNLOAD] Using cookie file: /path/to/cookies.txt
[DOWNLOAD] yt-dlp download completed successfully
```

## üîÑ Maintenance

- **Weekly**: Re-export cookies if doing heavy downloading
- **When failing**: Visit YouTube + re-export immediately  
- **Different tracks**: Some may work without cookies, others need them
- **Rate limiting**: Take breaks if you hit YouTube limits

---

üí° **Pro Tip**: Keep the cookie file fresh by visiting YouTube regularly in your browser! 